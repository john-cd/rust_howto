# Automatic Trait Derivation

{{#include derive.incl.md}}

## Derive Common Traits Automatically {#derive}

[![std][c~std~docs~badge]][c~std~docs]{{hi:Attributes}}{{hi:derive}}{{hi:Default implementation}}

Most structs and enums very commonly implement a number of basic traits - for example, to implement equality, cloning, enable storage in a hashmap, and provide debug formatting.

Instead of manually writing large amounts of repetitive code, you can apply the [`derive`][book~rust-reference~derive]↗{{hi:derive}} attribute to `struct` or `enum` definitions. The attribute, written `#[derive(<Trait_1>, <Trait_2>, ...)]`, where `<Trait_n>` should be replaced by a suitable trait name, automagically generates a basic implementation of the selected traits for the type you've annotated.

As described by [Derivable traits][book~rust~derivable-traits]↗{{hi:Derivable traits}}, the following traits are derivable "out of the box":

- Comparison traits [`Eq`][c~std::cmp::Eq~docs]↗{{hi:std::cmp::Eq}}, [`PartialEq`][c~std::cmp::PartialEq~docs]↗{{hi:std::cmp::PartialEq}}, [`Ord`][c~std::cmp::Ord~docs]↗{{hi:std::cmp::Ord}}, and [`PartialOrd`][c~std::cmp::PartialOrd~docs]↗{{hi:std::cmp::PartialOrd}},
- [`Clone`][c~std::clone::Clone~docs]↗{{hi:std::clone::Clone}}, which explicitly creates a deep copy of a value,
- [`Copy`][c~std::marker::Copy~docs]↗{{hi:std::marker::Copy}}, which gives a type 'copy semantics' instead of 'move semantics' (less common),
- [`Hash`][c~std::hash::Hash~docs]↗{{hi:std::hash::Hash}}, to compute a hash of the item,
- [`Default`][c~std::default::Default~docs]↗{{hi:std::default::Default}}, to provide a default instance of the type,
- [`Debug`][c~std::fmt::Debug~docs]↗{{hi:std::fmt::Debug}} to format the type for debug purposes.

The `PartialEq` trait allows checking for equality and enables use of the `==` and `!=` operators. The `Eq` trait signals that for _every_ value of a type, the value is equal to itself. The `PartialOrd` trait allows comparisons for sorting purposes. The `Ord` trait guarantees that, for _any_ two values of a type, a valid ordering will exist. Certain primitive types, namely floats, implement `PartialEq` and `PartialOrd` but cannot implement `Eq` and `Ord`.

The `Copy` trait marks types that can be duplicated (cloned) by solely copying bits stored on the stack.

The `Debug` trait enables debug formatting, which you request by adding `:?` within `{}` placeholders in format strings.

The `Default` trait provides the default value - the equivalent of an empty string or zero - for your type.

The `Hash` trait takes an instance of a type of arbitrary size and map that instance to a value of fixed size (a hash code, usually an integer) using a hash function. It is commonly required to use a type as a key in a [`HashMap`][c~std::collections::HashMap~docs]↗{{hi:std::collections::HashMap}} or [`HashSet`][c~std::collections::HashSet~docs]↗{{hi:std::collections::HashSet}}.

Note that the above traits can still be manually implemented, if a more complex behavior than what `derive` provides is required.

```rust,editable,editable
{{#include ../../crates/standard_library/examples/derive/derive.rs:example}}
```

Install and use the [`cargo-expand`][c~cargo-expand~docs]↗{{hi:cargo-expand}} utility to see the exact code that is generated by `derive` for your specific type.

It is possible to implement `derive` for your own custom traits through procedural [[macros | macros]].

## Derive Additional Traits with `derive_more` {#derive-more}

[![derive_more][c~derive_more~docs~badge]][c~derive_more~docs]{{hi:derive_more}}

The [derive_more][c~derive_more~crates.io]↗ crate derive lots of additional, commonly used traits and static methods for both structs{{hi:Structs}} and enums{{hi:Enums}}:

- Arithmetic Traits: [`Add`][c~std::ops::Add~docs]↗{{hi:std::ops::Add}}, [`Sub`][c~std::ops::Sub~docs]↗{{hi:std::ops::Sub}}, [`Mul`][c~std::ops::Mul~docs]↗{{hi:std::ops::Mul}}, [`Div`][c~std::ops::Div~docs]↗{{hi:std::ops::Div}}, `AddAssign`, `SubAssign`, `MulAssign`, etc. for custom numeric types,
- Conversion Traits: [`From`][c~std::convert::From~docs]↗{{hi:std::convert::From}}, [`Into`][c~std::convert::Into~docs]↗{{hi:std::convert::Into}}, [`TryFrom`][c~std::convert::TryFrom~docs]↗{{hi:std::convert::TryFrom}}, [`TryInto`][c~std::convert::TryInto~docs]↗{{hi:std::convert::TryInto}} for easy type conversions,
- Smart Pointer Traits: [`Deref`][c~std::ops::Deref~docs]↗{{hi:std::ops::Deref}}, [`DerefMut`][c~std::ops::DerefMut~docs]↗{{hi:std::ops::DerefMut}} for implementing container types,
- [`Display`][c~std::fmt::Display~docs]↗{{hi:std::fmt::Display}} and [`Error`][c~std::error::Error~docs]↗{{hi:std::error::Error}} for better formatting and error handling,
- `Constructor` to auto-generate constructors for structs,
- Boolean Operators [`Not`][c~std::ops::Not~docs]↗{{hi:std::ops::Not}}, [`BitAnd`][c~std::ops::BitAnd~docs]↗{{hi:std::ops::BitAnd}}, [`BitOr`][c~std::ops::BitOr~docs]↗{{hi:std::ops::BitOr}}, etc.

You can also implement `derive` for your own traits through procedural [[macros | macros]].

```rust,editable,noplayground
{{#include ../../crates/standard_library/examples/derive/derive_more.rs:example}}
```

## References {#references}

- [Derive (Rust reference)][book~rust-reference~derive]↗.

## Related Topics {#related-topics}

- [[attributes | Attributes]].
- [[macros | Macros]].
- [[rust-patterns | Rust Patterns]].

{{#include refs.incl.md}}
{{#include ../refs/link-refs.md}}

<div class="hidden">
</div>
